% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fn_ppwlr.R
\name{ppwlr}
\alias{ppwlr}
\title{Penalized Principal Weighted Logistic Regression (P\eqn{^2}WLR) for Sparse Sufficient Dimension Reduction}
\usage{
ppwlr(
  x,
  y,
  H = 10,
  C = 1,
  lambda = 0.001,
  gamma = 3.7,
  penalty = "grSCAD",
  max.iter = 100
)
}
\arguments{
\item{x}{Numeric predictor matrix (n x p), where n is the sample size and p is the number of predictors.}

\item{y}{Binary response vector of length n, coded as \code{-1, 1}.}

\item{H}{Number of quantile slices for principal machine construction.}

\item{C}{Regularization parameter.}

\item{lambda}{Penalty parameter for sparsity.}

\item{gamma}{Regularization parameter for SCAD/MCP penalty.}

\item{penalty}{Penalty type: \code{"grSCAD"}, \code{"grLasso"}, or \code{"grMCP"}.}

\item{max.iter}{Maximum number of iterations (default: 100).}
}
\value{
A list with components:
\item{Mn}{Estimated sufficient dimension reduction matrix.}
\item{evalues}{Eigenvalues of \code{Mn}.}
\item{evectors}{Eigenvectors spanning the SDR subspace.}
\item{x}{Original predictor matrix.}
}
\description{
Implements the penalized principal weighted logistic regression (P\eqn{^2}WLR) method for sparse sufficient dimension reduction (SDR), typically for binary responses.
}
\details{
This function fits a penalized principal machine using weighted logistic regression loss, which is well-suited for a binary classification in sufficient dimension reduction. Group penalties (SCAD, Lasso, MCP) are available for structured sparsity and variable selection. Only use with binary responses (\code{-1, 1}).
}
\examples{
\dontrun{
  set.seed(1)
  n <- 1000; p <- 10
  x <- MASS::mvrnorm(n, rep(0, p), diag(1, p))
  y <- (x \%*\% B[,1] / (0.5 + (x \%*\% B[,2] + 1)^2)) + 0.2 * rnorm(n)
  y.binary <- sign(y)
  fit <- ppwlr(x, y.binary, H = 10, C = 10, lambda = 0.02, gamma = 3.7,
               penalty = "grSCAD", max.iter = 100)
  fit$evectors[, 1:2]
}

}
